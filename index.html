<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>February 2026 Progress Tracker</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Overpass:wght@300;400;600;800&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --bg-primary: #0a0e1a;
        --bg-secondary: #151b2e;
        --bg-card: #1a2234;
        --accent-green: #5fd17a;
        --accent-pink: #fd8fe4;
        --accent-blue: #74e4f7;
        --accent-yellow: #fff27a;
        --accent-red: #f37373;
        --accent-orange: #f5a855;
        --text-primary: #e8eaf2;
        --text-secondary: #9aa1b8;
        --border: #2a3547;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Overpass", sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        min-height: 100vh;
        overflow-x: hidden;
      }

      /* Background effect */
      body::before {
        content: "";
        position: fixed;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background:
          radial-gradient(
            circle at 20% 50%,
            rgba(95, 209, 122, 0.08) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 80%,
            rgba(253, 143, 228, 0.08) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 40% 20%,
            rgba(116, 228, 247, 0.08) 0%,
            transparent 50%
          );
        animation: drift 20s ease-in-out infinite;
        z-index: 0;
      }

      @keyframes drift {
        0%,
        100% {
          transform: translate(0, 0) rotate(0deg);
        }
        33% {
          transform: translate(3%, 3%) rotate(1deg);
        }
        66% {
          transform: translate(-3%, 2%) rotate(-1deg);
        }
      }

      .container {
        position: relative;
        z-index: 1;
        max-width: 1400px;
        margin: 0 auto;
        padding: 40px 20px;
      }

      header {
        text-align: center;
        margin-bottom: 50px;
        animation: fadeInDown 0.8s ease-out;
      }

      h1 {
        font-family: "Space Mono", monospace;
        font-size: 3.5rem;
        font-weight: 700;
        margin-bottom: 10px;
        background: linear-gradient(
          135deg,
          var(--accent-green),
          var(--accent-blue)
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: -2px;
      }

      .subtitle {
        font-size: 1.1rem;
        color: var(--text-secondary);
        font-weight: 300;
        letter-spacing: 2px;
        text-transform: uppercase;
      }

      /* Dashboard Stats */
      .dashboard {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
        animation: fadeInUp 0.8s ease-out 0.2s backwards;
      }

      .stat-card {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 24px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .stat-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: var(--accent-color);
        transform: scaleX(0);
        transition: transform 0.3s ease;
      }

      .stat-card:hover::before {
        transform: scaleX(1);
      }

      .stat-card:hover {
        transform: translateY(-4px);
        border-color: var(--accent-color);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
      }

      .stat-label {
        font-size: 0.85rem;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 8px;
        font-weight: 600;
      }

      .stat-value {
        font-family: "Space Mono", monospace;
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--accent-color);
        line-height: 1;
      }

      .stat-subtext {
        font-size: 0.9rem;
        color: var(--text-secondary);
        margin-top: 8px;
      }

      /* Daily View */
      .daily-view {
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: 20px;
        padding: 30px;
        margin-bottom: 40px;
        animation: fadeInUp 0.8s ease-out 0.4s backwards;
      }

      .daily-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        flex-wrap: wrap;
        gap: 20px;
      }

      .daily-date {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .date-picker {
        display: flex;
        align-items: center;
        gap: 10px;
        background: var(--bg-card);
        padding: 12px 20px;
        border-radius: 12px;
        border: 1px solid var(--border);
      }

      .date-btn {
        background: none;
        border: none;
        color: var(--text-primary);
        font-size: 1.5rem;
        cursor: pointer;
        padding: 4px 8px;
        border-radius: 6px;
        transition: all 0.2s ease;
      }

      .date-btn:hover {
        background: var(--bg-secondary);
        color: var(--accent-blue);
      }

      .current-date {
        font-family: "Space Mono", monospace;
        font-size: 1.3rem;
        font-weight: 700;
        min-width: 200px;
        text-align: center;
      }

      .today-btn {
        background: var(--accent-green);
        color: var(--bg-primary);
        border: none;
        padding: 10px 20px;
        border-radius: 10px;
        font-family: "Space Mono", monospace;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        font-size: 0.9rem;
        letter-spacing: 1px;
      }

      .today-btn:hover {
        background: var(--accent-blue);
        transform: scale(1.05);
      }

      .view-toggle {
        display: flex;
        gap: 10px;
        background: var(--bg-card);
        padding: 6px;
        border-radius: 12px;
        border: 1px solid var(--border);
      }

      .toggle-btn {
        background: transparent;
        color: var(--text-secondary);
        border: none;
        padding: 10px 24px;
        border-radius: 8px;
        font-family: "Space Mono", monospace;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        font-size: 0.85rem;
        letter-spacing: 1px;
      }

      .toggle-btn:hover {
        color: var(--text-primary);
      }

      .toggle-btn.active {
        background: var(--accent-green);
        color: var(--bg-primary);
      }

      /* Task Checklist */
      .task-checklist {
        display: grid;
        gap: 16px;
      }

      .task-item {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 20px;
        display: grid;
        grid-template-columns: auto 1fr auto auto auto;
        gap: 20px;
        align-items: center;
        transition: all 0.3s ease;
      }

      .task-item:hover {
        border-color: var(--task-color);
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
      }

      .task-checkbox {
        width: 28px;
        height: 28px;
        border: 2px solid var(--task-color);
        border-radius: 8px;
        cursor: pointer;
        position: relative;
        transition: all 0.3s ease;
        flex-shrink: 0;
      }

      .task-checkbox.checked {
        background: var(--task-color);
      }

      .task-checkbox.checked::after {
        content: "✓";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: var(--bg-primary);
        font-size: 1.2rem;
        font-weight: 700;
      }

      .task-info {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .task-name {
        font-weight: 600;
        font-size: 1.1rem;
        color: var(--text-primary);
      }

      .task-schedule {
        font-size: 0.85rem;
        color: var(--text-secondary);
        font-family: "Space Mono", monospace;
      }

      .task-hours {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .hours-input {
        width: 70px;
        padding: 8px 12px;
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: 8px;
        color: var(--text-primary);
        font-family: "Space Mono", monospace;
        font-size: 0.95rem;
        text-align: center;
      }

      .hours-label {
        font-size: 0.85rem;
        color: var(--text-secondary);
        white-space: nowrap;
      }

      .progress-bar-container {
        width: 120px;
        height: 8px;
        background: var(--bg-secondary);
        border-radius: 4px;
        overflow: hidden;
      }

      .progress-bar {
        height: 100%;
        background: var(--task-color);
        transition: width 0.3s ease;
      }

      .task-status {
        font-size: 0.85rem;
        padding: 6px 12px;
        border-radius: 8px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        white-space: nowrap;
      }

      .status-complete {
        background: rgba(95, 209, 122, 0.2);
        color: var(--accent-green);
      }

      .status-partial {
        background: rgba(255, 242, 122, 0.2);
        color: var(--accent-yellow);
      }

      .status-skipped {
        background: rgba(243, 115, 115, 0.2);
        color: var(--accent-red);
      }

      /* Monthly Calendar */
      .monthly-view {
        animation: fadeInUp 0.8s ease-out 0.6s backwards;
      }

      .section-title {
        font-family: "Space Mono", monospace;
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 25px;
        color: var(--text-primary);
        letter-spacing: -1px;
      }

      .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 12px;
        margin-bottom: 40px;
      }

      .calendar-day {
        aspect-ratio: 1;
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .calendar-day:hover {
        transform: scale(1.05);
        border-color: var(--accent-blue);
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
      }

      .calendar-day.today {
        border: 2px solid var(--accent-green);
        box-shadow: 0 0 20px rgba(95, 209, 122, 0.3);
      }

      .day-number {
        font-family: "Space Mono", monospace;
        font-size: 1.2rem;
        font-weight: 700;
        margin-bottom: 8px;
      }

      .day-completion {
        font-size: 0.75rem;
        color: var(--text-secondary);
        margin-bottom: 8px;
      }

      .day-dots {
        display: flex;
        flex-wrap: wrap;
        gap: 3px;
      }

      .dot {
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background: var(--dot-color);
      }

      .calendar-day.high-productivity {
        background: linear-gradient(
          135deg,
          rgba(95, 209, 122, 0.1),
          rgba(116, 228, 247, 0.1)
        );
      }

      /* Action Buttons */
      .action-buttons {
        display: flex;
        gap: 15px;
        margin-top: 30px;
        justify-content: center;
        flex-wrap: wrap;
      }

      .action-btn {
        padding: 14px 28px;
        border: none;
        border-radius: 12px;
        font-family: "Space Mono", monospace;
        font-weight: 700;
        font-size: 0.95rem;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .btn-primary {
        background: var(--accent-green);
        color: var(--bg-primary);
      }

      .btn-primary:hover {
        background: var(--accent-blue);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(116, 228, 247, 0.4);
      }

      .btn-secondary {
        background: var(--bg-card);
        color: var(--text-primary);
        border: 1px solid var(--border);
      }

      .btn-secondary:hover {
        border-color: var(--accent-pink);
        color: var(--accent-pink);
        transform: translateY(-2px);
      }

      @keyframes fadeInDown {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Responsive */
      @media (max-width: 768px) {
        h1 {
          font-size: 2.5rem;
        }

        .task-item {
          grid-template-columns: auto 1fr;
          gap: 12px;
        }

        .task-hours,
        .progress-bar-container,
        .task-status {
          grid-column: 2;
        }

        .calendar-grid {
          grid-template-columns: repeat(4, 1fr);
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>FEBRUARY 2026</h1>
        <div class="subtitle">Progress Tracker</div>
      </header>

      <div class="dashboard" id="dashboard">
        <!-- Stats will be populated by JavaScript -->
      </div>

      <div class="daily-view">
        <div class="daily-header">
          <div class="daily-date">
            <div class="date-picker">
              <button class="date-btn" onclick="changeDay(-1)">←</button>
              <div class="current-date" id="currentDate"></div>
              <button class="date-btn" onclick="changeDay(1)">→</button>
            </div>
            <button class="today-btn" onclick="goToToday()">Today</button>
          </div>
          <div class="view-toggle">
            <button
              class="toggle-btn"
              id="studyBtn"
              onclick="switchView('study')"
            >
              Study
            </button>
            <button
              class="toggle-btn"
              id="wellnessBtn"
              onclick="switchView('wellness')"
            >
              Wellness
            </button>
          </div>
        </div>

        <div class="task-checklist" id="taskChecklist">
          <!-- Tasks will be populated by JavaScript -->
        </div>

        <div class="action-buttons">
          <button class="action-btn btn-primary" onclick="saveDailyProgress()">
            Save Progress
          </button>
          <button class="action-btn btn-secondary" onclick="exportData()">
            Export Data
          </button>
        </div>
      </div>

      <div class="monthly-view">
        <h2 class="section-title">Study - Monthly Overview</h2>
        <div class="calendar-grid" id="studyCalendarGrid">
          <!-- Study calendar will be populated by JavaScript -->
        </div>

        <h2 class="section-title" style="margin-top: 60px">
          Wellness - Monthly Overview
        </h2>
        <div class="calendar-grid" id="wellnessCalendarGrid">
          <!-- Wellness calendar will be populated by JavaScript -->
        </div>
      </div>
    </div>

    <script>
      // Task definitions separated by category
      const wellnessTasks = [
        {
          id: "sleep",
          name: "Sleep",
          color: "#3c64c8",
          scheduledHours: 8,
          schedule: "11:00 PM - 7:00 AM",
        },
        {
          id: "workout",
          name: "Workout",
          color: "#f37373",
          scheduledHours: 1,
          schedule: "7:00 AM",
        },
        {
          id: "yoga",
          name: "Yoga",
          color: "#fff27a",
          scheduledHours: 0.5,
          schedule: "8:00 AM",
        },
        {
          id: "breakfast",
          name: "Breakfast",
          color: "#fff27a",
          scheduledHours: 1,
          schedule: "8:30 AM",
        },
        {
          id: "midday",
          name: "Mid-day Snack",
          color: "#fff27a",
          scheduledHours: 0.5,
          schedule: "11:30 AM",
        },
        {
          id: "lunch",
          name: "Lunch",
          color: "#fff27a",
          scheduledHours: 1,
          schedule: "2:00 PM",
        },
        {
          id: "skincare",
          name: "Skin & Body Care",
          color: "#fff27a",
          scheduledHours: 1,
          schedule: "5:00 PM",
        },
        {
          id: "dinner",
          name: "Dinner",
          color: "#fff27a",
          scheduledHours: 1,
          schedule: "8:00 PM",
        },
      ];

      const studyTasks = [
        {
          id: "java",
          name: "Java Study",
          color: "#fd8fe4",
          scheduledHours: 3,
          schedule: "Multiple sessions",
        },
        {
          id: "aiml",
          name: "AI/ML Study",
          color: "#74e4f7",
          scheduledHours: 3,
          schedule: "Multiple sessions",
        },
        {
          id: "practice",
          name: "Practice Sessions",
          color: "#c6e3ee",
          scheduledHours: 2,
          schedule: "Morning & Afternoon",
        },
        {
          id: "research",
          name: "Research",
          color: "#5fd17a",
          scheduledHours: 2,
          schedule: "9:00 PM - 11:00 PM",
        },
        {
          id: "ielts",
          name: "IELTS Preparation",
          color: "#f5a855",
          scheduledHours: 2,
          schedule: "Tuesday, Thursday, Saturday",
        },
      ];

      const allTasks = [...wellnessTasks, ...studyTasks];

      // Initialize data structure
      let progressData = loadProgressData();
      let currentDay = new Date(); // Use actual current date
      let currentView = localStorage.getItem("currentView") || "study"; // 'study' or 'wellness'

      function loadProgressData() {
        let data = JSON.parse(localStorage.getItem("februaryProgress"));

        if (!data) {
          return initializeMonth();
        }

        // Migrate old data to include new wellness tasks
        for (let day = 1; day <= 28; day++) {
          if (!data[day]) {
            data[day] = { tasks: {}, notes: "" };
          }

          // Add any missing tasks
          allTasks.forEach((task) => {
            if (!data[day].tasks[task.id]) {
              data[day].tasks[task.id] = {
                completed: false,
                hoursLogged: 0,
                status: "pending",
              };
            }
          });
        }

        // Save migrated data
        localStorage.setItem("februaryProgress", JSON.stringify(data));
        return data;
      }

      function initializeMonth() {
        const data = {};
        for (let day = 1; day <= 28; day++) {
          // February 2026 has 28 days (not a leap year)
          data[day] = {
            tasks: {},
            notes: "",
          };
          allTasks.forEach((task) => {
            data[day].tasks[task.id] = {
              completed: false,
              hoursLogged: 0,
              status: "pending", // pending, complete, partial, skipped
            };
          });
        }
        return data;
      }

      function getDayOfWeek(day) {
        const date = new Date(2026, 1, day);
        return date.getDay(); // 0 = Sunday, 1 = Monday, etc.
      }

      function getTasksForDay(day, view = currentView) {
        const dayOfWeek = getDayOfWeek(day);

        if (view === "wellness") {
          // Wellness tasks are the same every day
          return wellnessTasks;
        }

        // Study tasks vary by day
        // Sunday has different schedule
        if (dayOfWeek === 0) {
          return studyTasks.filter((t) => ["practice"].includes(t.id));
        }

        // Tuesday, Thursday, Saturday have IELTS instead of Research
        if ([2, 4, 6].includes(dayOfWeek)) {
          return studyTasks.filter((t) => t.id !== "research");
        }

        // Other days have Research instead of IELTS
        return studyTasks.filter((t) => t.id !== "ielts");
      }

      function renderDashboard() {
        const dashboard = document.getElementById("dashboard");

        // Calculate stats based on current view
        let totalHoursLogged = 0;
        let totalScheduledHours = 0;
        let lazyHours = 0;
        let consistentDays = 0;
        let completionRates = {};

        const tasksToTrack =
          currentView === "study" ? studyTasks : wellnessTasks;

        tasksToTrack.forEach((task) => {
          completionRates[task.id] = { logged: 0, scheduled: 0 };
        });

        const today = new Date().getDate(); // Use actual current date

        for (let day = 1; day <= 28; day++) {
          const dayData = progressData[day];
          const dayTasks = getTasksForDay(day, currentView);

          let dayComplete = true;
          dayTasks.forEach((task) => {
            const taskData = dayData.tasks[task.id];

            // Only count stats for days up to today
            if (day <= today) {
              totalHoursLogged += taskData.hoursLogged || 0;
              totalScheduledHours += task.scheduledHours;

              completionRates[task.id].logged += taskData.hoursLogged || 0;
              completionRates[task.id].scheduled += task.scheduledHours;

              // Count any unlogged hours as lazy hours
              const unloggedHours =
                task.scheduledHours - (taskData.hoursLogged || 0);
              if (unloggedHours > 0) {
                lazyHours += unloggedHours;
              }

              if (!taskData.completed) {
                dayComplete = false;
              }
            }
          });

          if (dayComplete && day <= today) consistentDays++;
        }

        const consistencyRate =
          totalScheduledHours > 0
            ? ((totalHoursLogged / totalScheduledHours) * 100).toFixed(1)
            : "0.0";
        const viewLabel = currentView === "study" ? "Study" : "Wellness";

        dashboard.innerHTML = `
        <div class="stat-card" style="--accent-color: #5fd17a">
          <div class="stat-label">${viewLabel} Hours Logged</div>
          <div class="stat-value">${totalHoursLogged.toFixed(1)}</div>
          <div class="stat-subtext">of ${totalScheduledHours} scheduled</div>
        </div>
        
        <div class="stat-card" style="--accent-color: #74e4f7">
          <div class="stat-label">${viewLabel} Consistency</div>
          <div class="stat-value">${consistencyRate}%</div>
          <div class="stat-subtext">${consistentDays} fully consistent days</div>
        </div>
        
        <div class="stat-card" style="--accent-color: #f37373">
          <div class="stat-label">${viewLabel} Lazy Hours</div>
          <div class="stat-value">${lazyHours.toFixed(1)}</div>
          <div class="stat-subtext">Hours not logged</div>
        </div>
        
        <div class="stat-card" style="--accent-color: #fd8fe4">
          <div class="stat-label">${viewLabel} Streak</div>
          <div class="stat-value">${calculateStreak()}</div>
          <div class="stat-subtext">consecutive days</div>
        </div>
      `;
      }

      function calculateStreak() {
        let streak = 0;
        const today = currentDay.getDate();

        for (let day = today; day >= 1; day--) {
          const dayData = progressData[day];
          const dayTasks = getTasksForDay(day, currentView);
          let dayComplete = true;

          dayTasks.forEach((task) => {
            if (!dayData.tasks[task.id].completed) {
              dayComplete = false;
            }
          });

          if (dayComplete) {
            streak++;
          } else {
            break;
          }
        }

        return streak;
      }

      function renderDailyView() {
        const day = currentDay.getDate();
        const dateStr = currentDay.toLocaleDateString("en-US", {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        });

        document.getElementById("currentDate").textContent = dateStr;

        // Update toggle button states
        document
          .getElementById("studyBtn")
          .classList.toggle("active", currentView === "study");
        document
          .getElementById("wellnessBtn")
          .classList.toggle("active", currentView === "wellness");

        const dayTasks = getTasksForDay(day, currentView);
        const dayData = progressData[day];
        const checklist = document.getElementById("taskChecklist");

        if (dayTasks.length === 0) {
          checklist.innerHTML = `
          <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
            <p style="font-size: 1.2rem;">No ${currentView} tasks scheduled for this day</p>
          </div>
        `;
          return;
        }

        checklist.innerHTML = dayTasks
          .map((task) => {
            const taskData = dayData.tasks[task.id] || {
              completed: false,
              hoursLogged: 0,
            };
            const progress = (taskData.hoursLogged / task.scheduledHours) * 100;
            const statusClass = taskData.completed
              ? "status-complete"
              : taskData.hoursLogged > 0
                ? "status-partial"
                : "status-skipped";
            const statusText = taskData.completed
              ? "Complete"
              : taskData.hoursLogged > 0
                ? "Partial"
                : "Pending";

            return `
          <div class="task-item" style="--task-color: ${task.color}">
            <div class="task-checkbox ${taskData.completed ? "checked" : ""}" 
                 onclick="toggleTask('${task.id}')"></div>
            <div class="task-info">
              <div class="task-name">${task.name}</div>
              <div class="task-schedule">${task.schedule} • ${task.scheduledHours}h scheduled</div>
            </div>
            <div class="task-hours">
              <input type="number" 
                     class="hours-input" 
                     value="${taskData.hoursLogged}" 
                     min="0" 
                     max="${task.scheduledHours * 2}" 
                     step="0.5"
                     onchange="updateHours('${task.id}', this.value)">
              <span class="hours-label">hours</span>
            </div>
            <div class="progress-bar-container">
              <div class="progress-bar" style="width: ${Math.min(progress, 100)}%; background: ${task.color}"></div>
            </div>
            <div class="task-status ${statusClass}">${statusText}</div>
          </div>
        `;
          })
          .join("");
      }

      function switchView(view) {
        currentView = view;
        localStorage.setItem("currentView", view);
        renderDailyView();
        renderDashboard();
        renderCalendar();
      }

      function toggleTask(taskId) {
        const day = currentDay.getDate();
        const taskData = progressData[day].tasks[taskId];
        taskData.completed = !taskData.completed;

        // Auto-set hours to scheduled if completing, reset to 0 if unchecking
        if (taskData.completed && taskData.hoursLogged === 0) {
          const task = allTasks.find((t) => t.id === taskId);
          taskData.hoursLogged = task.scheduledHours;
        } else if (!taskData.completed) {
          // Reset hours to 0 when unchecking
          taskData.hoursLogged = 0;
        }

        saveData();
        renderDailyView();
        renderDashboard();
        renderCalendar();
      }

      function updateHours(taskId, hours) {
        const day = currentDay.getDate();
        const taskData = progressData[day].tasks[taskId];
        const task = allTasks.find((t) => t.id === taskId);

        taskData.hoursLogged = parseFloat(hours) || 0;
        taskData.completed = taskData.hoursLogged >= task.scheduledHours;

        saveData();
        renderDailyView();
        renderDashboard();
        renderCalendar();
      }

      function renderCalendar() {
        renderCalendarForView("study", "studyCalendarGrid");
        renderCalendarForView("wellness", "wellnessCalendarGrid");
      }

      function renderCalendarForView(view, gridId) {
        const grid = document.getElementById(gridId);
        const today = new Date().getDate(); // Use actual current date

        let html = "";

        for (let day = 1; day <= 28; day++) {
          const dayData = progressData[day];
          const dayTasks = getTasksForDay(day, view);

          let completedTasks = 0;
          dayTasks.forEach((task) => {
            if (dayData.tasks[task.id].completed) {
              completedTasks++;
            }
          });

          const completionRate =
            dayTasks.length > 0
              ? ((completedTasks / dayTasks.length) * 100).toFixed(0)
              : "0";
          const isToday = day === today;
          const isHighProductivity = completionRate >= 80;

          html += `
          <div class="calendar-day ${isToday ? "today" : ""} ${isHighProductivity ? "high-productivity" : ""}" 
               onclick="goToDayWithView(${day}, '${view}')">
            <div class="day-number">${day}</div>
            <div class="day-completion">${completionRate}% complete</div>
            <div class="day-dots">
              ${dayTasks
                .slice(0, 12)
                .map((task) => {
                  const isDone = dayData.tasks[task.id].completed;
                  return `<div class="dot" style="--dot-color: ${isDone ? task.color : "#2a3547"}"></div>`;
                })
                .join("")}
            </div>
          </div>
        `;
        }

        grid.innerHTML = html;
      }

      function changeDay(delta) {
        const newDay = currentDay.getDate() + delta;
        if (newDay >= 1 && newDay <= 28) {
          currentDay = new Date(2026, 1, newDay);
          renderDailyView();
        }
      }

      function goToDay(day) {
        currentDay = new Date(2026, 1, day);
        renderDailyView();
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function goToDayWithView(day, view) {
        currentDay = new Date(2026, 1, day);
        currentView = view;
        localStorage.setItem("currentView", view);
        renderDailyView();
        renderDashboard();
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function goToToday() {
        currentDay = new Date(); // Use actual current date
        renderDailyView();
      }

      function saveDailyProgress() {
        saveData();
        window.scrollTo({ top: 0, behavior: "instant" });
        location.reload();
      }

      function saveData() {
        localStorage.setItem("februaryProgress", JSON.stringify(progressData));
      }

      function exportData() {
        const dataStr = JSON.stringify(progressData, null, 2);
        const dataBlob = new Blob([dataStr], { type: "application/json" });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement("a");
        link.href = url;
        link.download = "february-2026-progress.json";
        link.click();
      }

      // Initialize on load
      renderDashboard();
      renderDailyView();
      renderCalendar();
    </script>
  </body>
</html>
